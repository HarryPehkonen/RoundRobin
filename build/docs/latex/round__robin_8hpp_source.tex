\hypertarget{round__robin_8hpp_source}{}\doxysection{round\+\_\+robin.\+hpp}
\label{round__robin_8hpp_source}\index{/home/harri/Dropbox/code/round\_robin/include/round\_robin/round\_robin.hpp@{/home/harri/Dropbox/code/round\_robin/include/round\_robin/round\_robin.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef ROUND\_ROBIN\_HPP}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define ROUND\_ROBIN\_HPP}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include <forward\_list>}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include <stdexcept>}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include <utility>} \textcolor{comment}{// For std::move}}
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include <cassert>} \textcolor{comment}{// For assert (used in debug checks)}}
\DoxyCodeLine{8 }
\DoxyCodeLine{9 \textcolor{keyword}{namespace }rr \{}
\DoxyCodeLine{10 }
\DoxyCodeLine{20 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{21 \textcolor{keyword}{class }\mbox{\hyperlink{classrr_1_1RoundRobin}{RoundRobin}} \{}
\DoxyCodeLine{22 \textcolor{keyword}{private}:}
\DoxyCodeLine{27     \textcolor{keyword}{struct }Item \{}
\DoxyCodeLine{28         T value; }
\DoxyCodeLine{29         \textcolor{keywordtype}{bool} visited; }
\DoxyCodeLine{30         }
\DoxyCodeLine{35         Item(T\&\& v) : value(std::move(v)), visited(\textcolor{keyword}{false}) \{\}}
\DoxyCodeLine{36         }
\DoxyCodeLine{41         Item(\textcolor{keyword}{const} T\& v) : value(v), visited(\textcolor{keyword}{false}) \{\}}
\DoxyCodeLine{42     \};}
\DoxyCodeLine{43 }
\DoxyCodeLine{44     std::forward\_list<Item> items\_; }
\DoxyCodeLine{45     \textcolor{keyword}{typename} std::forward\_list<Item>::iterator current\_; }
\DoxyCodeLine{46     \textcolor{keywordtype}{size\_t} count\_ = 0; }
\DoxyCodeLine{47 }
\DoxyCodeLine{52     \textcolor{keywordtype}{bool} all\_visited()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{53         \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}\& item : items\_) \{}
\DoxyCodeLine{54             \textcolor{keywordflow}{if} (!item.visited) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{55         \}}
\DoxyCodeLine{56         \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{57     \}}
\DoxyCodeLine{58 }
\DoxyCodeLine{62     \textcolor{keywordtype}{void} reset\_visited() \{}
\DoxyCodeLine{63         \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\& item : items\_) \{}
\DoxyCodeLine{64             item.visited = \textcolor{keyword}{false};}
\DoxyCodeLine{65         \}}
\DoxyCodeLine{66     \}}
\DoxyCodeLine{67 }
\DoxyCodeLine{68 \textcolor{keyword}{public}:}
\DoxyCodeLine{72     \mbox{\hyperlink{classrr_1_1RoundRobin_a6ee7e208a867abd3150ca9d34f174b7e}{RoundRobin}}() : current\_(items\_.before\_begin()) \{\}}
\DoxyCodeLine{73 }
\DoxyCodeLine{78     \mbox{\hyperlink{classrr_1_1RoundRobin_aa73f267a9c1315db41f144a00e0f7285}{RoundRobin}}(\mbox{\hyperlink{classrr_1_1RoundRobin}{RoundRobin}}\&\& other) noexcept }
\DoxyCodeLine{79         : items\_(std::move(other.items\_))}
\DoxyCodeLine{80        , current\_(items\_.before\_begin())}
\DoxyCodeLine{81        , count\_(other.count\_) \{}
\DoxyCodeLine{82         other.count\_ = 0;}
\DoxyCodeLine{83     \}}
\DoxyCodeLine{84 }
\DoxyCodeLine{90     \mbox{\hyperlink{classrr_1_1RoundRobin}{RoundRobin}}\& \mbox{\hyperlink{classrr_1_1RoundRobin_aef805fbf82f42de3b045f14d81391008}{operator=}}(\mbox{\hyperlink{classrr_1_1RoundRobin}{RoundRobin}}\&\& other) \textcolor{keyword}{noexcept} \{}
\DoxyCodeLine{91         \textcolor{keywordflow}{if} (\textcolor{keyword}{this}!= \&other) \{}
\DoxyCodeLine{92             items\_ = std::move(other.items\_);}
\DoxyCodeLine{93             current\_ = items\_.before\_begin();}
\DoxyCodeLine{94             count\_ = other.count\_;}
\DoxyCodeLine{95             other.count\_ = 0;}
\DoxyCodeLine{96         \}}
\DoxyCodeLine{97         \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{98     \}}
\DoxyCodeLine{99 }
\DoxyCodeLine{100     \textcolor{comment}{// Disable copy constructor and assignment operator}}
\DoxyCodeLine{101     \mbox{\hyperlink{classrr_1_1RoundRobin_a6ee7e208a867abd3150ca9d34f174b7e}{RoundRobin}}(\textcolor{keyword}{const} \mbox{\hyperlink{classrr_1_1RoundRobin}{RoundRobin}}\&) = \textcolor{keyword}{delete};}
\DoxyCodeLine{102     \mbox{\hyperlink{classrr_1_1RoundRobin}{RoundRobin}}\& \mbox{\hyperlink{classrr_1_1RoundRobin_aef805fbf82f42de3b045f14d81391008}{operator=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classrr_1_1RoundRobin}{RoundRobin}}\&) = \textcolor{keyword}{delete};}
\DoxyCodeLine{103 }
\DoxyCodeLine{108     \textcolor{keywordtype}{void} \mbox{\hyperlink{classrr_1_1RoundRobin_af470839118473380e5d591002402520c}{add}}(\textcolor{keyword}{const} T\& item) \{}
\DoxyCodeLine{109         items\_.push\_front(Item(item));}
\DoxyCodeLine{110         ++count\_;}
\DoxyCodeLine{111     \}}
\DoxyCodeLine{112 }
\DoxyCodeLine{117     \textcolor{keywordtype}{void} \mbox{\hyperlink{classrr_1_1RoundRobin_ae4a9b837f9dceba5efdf97def06cdcc6}{add}}(T\&\& item) \{}
\DoxyCodeLine{118         items\_.push\_front(Item(std::move(item)));}
\DoxyCodeLine{119         ++count\_;}
\DoxyCodeLine{120     \}}
\DoxyCodeLine{121 }
\DoxyCodeLine{128     T* \mbox{\hyperlink{classrr_1_1RoundRobin_a71572769f648bee218acef65782c2e81}{try\_next}}() \{}
\DoxyCodeLine{129         \textcolor{keywordflow}{if} (items\_.empty()) \{}
\DoxyCodeLine{130             current\_ = items\_.before\_begin();}
\DoxyCodeLine{131             \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{132         \}}
\DoxyCodeLine{133         }
\DoxyCodeLine{134         \textcolor{keywordflow}{if} (all\_visited()) \{}
\DoxyCodeLine{135             reset\_visited();}
\DoxyCodeLine{136         \}}
\DoxyCodeLine{137         }
\DoxyCodeLine{138         \textcolor{comment}{// Track previous position for potential removal}}
\DoxyCodeLine{139         \textcolor{keyword}{auto} prev = items\_.before\_begin();}
\DoxyCodeLine{140         \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} it = items\_.begin(); it!= items\_.end(); ++it) \{}
\DoxyCodeLine{141             \textcolor{keywordflow}{if} (!it-\/>visited) \{}
\DoxyCodeLine{142                 it-\/>visited = \textcolor{keyword}{true};}
\DoxyCodeLine{143                 current\_ = prev;  \textcolor{comment}{// Store previous iterator for remove\_current()}}
\DoxyCodeLine{144                 \textcolor{keywordflow}{return} \&it-\/>value;}
\DoxyCodeLine{145             \}}
\DoxyCodeLine{146             prev = it;}
\DoxyCodeLine{147         \}}
\DoxyCodeLine{148         }
\DoxyCodeLine{149         \textcolor{comment}{// Should never reach here since we reset visits if all were visited}}
\DoxyCodeLine{150         assert(!items\_.empty()); \textcolor{comment}{// Defensive programming}}
\DoxyCodeLine{151         current\_ = items\_.before\_begin();}
\DoxyCodeLine{152         \textcolor{keywordflow}{return} \&items\_.front().value;}
\DoxyCodeLine{153     \}}
\DoxyCodeLine{154 }
\DoxyCodeLine{162     T\& \mbox{\hyperlink{classrr_1_1RoundRobin_a2351f7ea3372ae17c0dc092e887f1694}{next}}() \{}
\DoxyCodeLine{163         T* result = \mbox{\hyperlink{classrr_1_1RoundRobin_a71572769f648bee218acef65782c2e81}{try\_next}}();}
\DoxyCodeLine{164         \textcolor{keywordflow}{if} (!result) \{}
\DoxyCodeLine{165             \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}Attempted to get next item from empty RoundRobin"{}});}
\DoxyCodeLine{166         \}}
\DoxyCodeLine{167         \textcolor{keywordflow}{return} *result;}
\DoxyCodeLine{168     \}}
\DoxyCodeLine{169 }
\DoxyCodeLine{178     \textcolor{keywordtype}{void} \mbox{\hyperlink{classrr_1_1RoundRobin_a80b77951f71243f9c03c05de2cf4f59a}{remove\_current}}() \{}
\DoxyCodeLine{179         \textcolor{keywordflow}{if} (items\_.empty()) \{}
\DoxyCodeLine{180             \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}Attempted to remove from empty RoundRobin"{}});}
\DoxyCodeLine{181         \}}
\DoxyCodeLine{182         }
\DoxyCodeLine{183         \textcolor{keyword}{auto} \mbox{\hyperlink{classrr_1_1RoundRobin_a2351f7ea3372ae17c0dc092e887f1694}{next}} = std::next(current\_);}
\DoxyCodeLine{184         \textcolor{keywordflow}{if} (\mbox{\hyperlink{classrr_1_1RoundRobin_a2351f7ea3372ae17c0dc092e887f1694}{next}} == items\_.end()) \{}
\DoxyCodeLine{185             \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}Invalid current position in RoundRobin"{}});}
\DoxyCodeLine{186         \}}
\DoxyCodeLine{187         }
\DoxyCodeLine{188         items\_.erase\_after(current\_);}
\DoxyCodeLine{189         -\/-\/count\_;}
\DoxyCodeLine{190         }
\DoxyCodeLine{191         \textcolor{comment}{// If we removed the last item, reset current}}
\DoxyCodeLine{192         \textcolor{keywordflow}{if} (items\_.empty()) \{}
\DoxyCodeLine{193             current\_ = items\_.before\_begin();}
\DoxyCodeLine{194         \}}
\DoxyCodeLine{195     \}}
\DoxyCodeLine{196 }
\DoxyCodeLine{201     \textcolor{keywordtype}{bool} \mbox{\hyperlink{classrr_1_1RoundRobin_ad392d7ddea825c1f6f4d0dc8f1cea320}{empty}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{202         \textcolor{keywordflow}{return} count\_ == 0;}
\DoxyCodeLine{203     \}}
\DoxyCodeLine{204 }
\DoxyCodeLine{209     \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classrr_1_1RoundRobin_ae3b3fe280e8f6f5fb356c6c1f13fca0c}{size}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{210         \textcolor{keywordflow}{return} count\_;}
\DoxyCodeLine{211     \}}
\DoxyCodeLine{212 \};}
\DoxyCodeLine{213 }
\DoxyCodeLine{214 \} \textcolor{comment}{// namespace rr}}
\DoxyCodeLine{215 }
\DoxyCodeLine{216 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// ROUND\_ROBIN\_HPP}}

\end{DoxyCode}
